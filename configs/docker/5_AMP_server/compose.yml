name: "amp_server"

services:

  apache_php_container:
    # spawn from a Dockerfile
    build:
      context: "./"
      target: "apache_server_img"
    # mount the directory containing the web app files to "/var/www/html"
    volumes:
    # - "D:\\code\\esaip_repo\\S3\\php\\8_axocamp_MVC:/var/www/html:ro"
    # - "D:\\code\\esaip_repo\\S3\\php\\9_immatriculation:/var/www/html:ro"
    - "C:\\Users\\Arthur\\code\\esaip_repo\\S3\\php\\9_immatriculation:/var/www/html:ro"
    # expose the HTTP port
    ports:
    - "80:80"
    # allow everything for everything in /var/www/html for everyone
    command: "bash -c 'chmod -R 777 /var/www/html/
      && apache2-foreground'"
    # entrypoint: "bash"
    # command:
    #   - "-c"
    #   - "chmod -R 777 /var/www/html/ && apache2-foreground"
    # command: "apache2-foreground"

  mysql_container:
    image: "mysql:9.1"
    ports:
    - "3306:3306"
    # mount a local directory to save the database files
    volumes:
    # - "mysql_data:/var/lib/mysql"
    - "./data:/var/lib/mysql"
    environment:
      MYSQL_ROOT_PASSWORD: "123456789"

  phpmyadmin_container:
    # spawn from the official phpmyadmin image
    image: "phpmyadmin:5.2.1-apache"
    # expose the HTTP port
    ports:
    - "8080:80"
    # define the default host as "mysql_container"
    environment:
      PMA_HOST: "mysql_container"
